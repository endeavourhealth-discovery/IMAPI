# Specification - QOF JSON definition to IMQ definition

## Introduction
NHS Produces a number of specifications for the QOF (Quality and Outcomes Framework) 
data. These specifications are used to define the structure of the data that is 
submitted to NHS England. The specifications are sub-divided into the following 4
main sections: -

* Patient Selection Criteria (Selections) - The "Qualifying criteria" for a patient to be included in the QOF data.
* Populations (Registers) - The "Population" of patients that are included in the QOF data.
* Extraction Criteria (Extractions) - The data that should be extracted from the patient records (along with cluster and qualifying criteri values).
* Outputs (Indicators) - The Indicators that should be calculated from the data (including the rules and descriptions)

An example of this can be seen in the `QOF-Diabetes.md` file.

## Machine readable QOF
The specifications, such as the example above, have been parsed and summarised in JSON format. An example of this
can be seen in the `QOF-Diabetes.json` file (generated from `QOF-Diabetes.md`). The JSON files
conform to the structure represented by the `model/qof/QOFDocument` java class.

## IMQuery language
Internally, the QOF data is processed using a query language called IMQuery. This language is used as an interim language
that is subsequently converted to SQL for execution against the database. Examples of the IMQuery language can be seen in
the second column of the `example-queries.tsv` file. This JSON structure conforms to the `model/imq/Query` Java class.

## Phases

### Phase 1
Given the `QOFDocument` class, the content of the `QOF-Diabetes.md` file, and the content of the extracted `QOF-Diabetes.json` data, create a
generic (not Diabetes specific) specification for the QOF JSON file format. You may use the diabetes example as a reference.
You may include content from the diabetes document as examples in the specification. Save as `2.QOF-Specification.md`. Do not generate code.

### Phase 2
Given the `Query` class and example IMQueries in the second column of the `example-queries.tsv` file, create a specification for the IMQuery language. 
Save as `3.IMQ-Specification.md`.

### Phase 3
Using the specifications created in phases 1 & 2, create a comprehensive specification document that describes
the conversion from QOF JSON to IMQuery format, including input/output specifications, conversion rules, and data transformation patterns.
Save as `4.QOF-To-IMQ-Specification.md`.

### Phase 4 
Given the `4.QOF-To-IMQ-Specification.md` specification, create a code generator that converts from QOF to IMQuery.
